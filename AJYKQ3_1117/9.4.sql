CREATE DATABASE AJYKQ3;
USE AJYKQ3;
CREATE TABLE GYARTO(adoszam INT PRIMARY KEY, nev CHAR(30) NOT NULL, telephely CHAR(50));
CREATE TABLE TERMEK(tkod INT PRIMARY KEY, nev CHAR(30) NOT NULL, ear INT CHECK(ear>0), gyarto INT REFERENCES GYARTO);



INSERT INTO GYARTO VALUES(11111111, "mediamarkt", 4090);
INSERT INTO GYARTO VALUES(33333333, "lidl", 6024);
INSERT INTO GYARTO VALUES(44444444, "penny", 1046);
INSERT INTO GYARTO VALUES(22222222, "obi", 3021);



ALTER TABLE termek ADD (kategoria CHAR(50));

INSERT INTO TERMEK VALUES(0, "billentyűzet", 5000, 11111111, "ELEKTRONIKA");
INSERT INTO TERMEK VALUES(5, "ELEM", 300, 44444444, "ELEKTRONIKA");
INSERT INTO TERMEK VALUES(2, "lámpa", 3000, 22222222, "ELEKTRONIKA");
INSERT INTO TERMEK VALUES(1, "ásó", 2000, 22222222, "MINDENNAPOK");
INSERT INTO TERMEK VALUES(3, "monitor", 15000, 33333333, "ELEKTRONIKA");
INSERT INTO TERMEK VALUES(4, "szőnyeg", 10000, 22222222, "MINDENNAPOK");



CREATE VIEW kgy AS SELECT g.adoszam, t.kategoria FROM gyarto g LEFT OUTER JOIN termek t ON g.adoszam = t.gyarto GROUP BY g.adoszam, t.kategoria;
CREATE VIEW kgy2 AS SELECT kategoria, COUNT(adoszam) db FROM kgy GROUP BY kategoria;
SELECT kategoria FROM kgy2 WHERE db = (SELECT COUNT(*) FROM gyarto);